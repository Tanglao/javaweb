1. 如何解决消息发送一致性问题
2. JMS如何解决消息发送一致性问题
3. 如何解决消息中间件与使用者的强依赖问题
4. 消息投递可靠性如何保证
5. 消息投递收到确认处理成功的消息很慢如何解决
6. 消息重复产生的原因
7. 订阅者如何解决消息重复的产生
8. 如何设计保证顺序的消息队列
9. 如何解决本地消息存储的可靠性
10. 如何支持队列的扩容
11. 软负载中心的作用
12. 如何解决大量数据同时插入更新时的性能问题
13. 如何解决服务上下线感知问题
14. 如何提高数据分发的性能
15. 软负载中心怎么区分线上测试、预发布、开发环境
16. 如何优雅停止应用
17. 负载中心单机变集群时，如何管理数据

答：

1. 发送给MQ 1 消息状态为Prepared-2 业务操作-3发送给MQ 消息状态为ack。 2-3 步可能丢失消息，mq回去询问操作（业务应用监听Prepared状态的消息）。支付宝回调
2. JMS 采用分布式事务支持，开销比较大
3. 业务应用采用数据库存储事务或本地存储消息
4. 业务操作完成再发送消费确认消息
5. 异步化
6. 消息发送方因为中间件问题发送了重复消息、消息中间件存储消息后返回确认给生产方超时，消费方返回确认信息时应用挂了，重复投递
7. 幂等性
8. 入队按顺序，拉模式消费消息，记录消费位置
9. 主备模式，根据业务情况做同步复制或异步复制
10. 旧的队列标识不接受新消息，通知发送端新的队列位置，发送到新的队列
11. 存储机器地址配置信息
12. ConcurrentHashMap并发容器，一个线程操作一个linklist，无锁化
13. 心跳检测。如果错判，由服务调用者进行最终确认
14. 数据压缩，多线程，初期全量后期增量
15. 地址列表增加分组标识
16. 线程服务地址列表移除该机器，再停机
17. 配置信息单独抽离出来，由对等的机器负责分发



